<script type="text/discourse-plugin" version="0.8">
    var baseURL = "test.tiaa-forum.org";
// replace login button with a button that uses the WordPress SSO login so that login state is consistent between WP 
// and Discourse. supplied login button display set to none in CSS
//    if((!Discourse.User.current())) { // Depricated in Discourse 2.4 
    if (!api.getCurrentUser()) {
      api.decorateWidget('header-icons:before', helper => {
          return helper.h('li', [
              helper.h('a.tiaa-login-button.btn.btn-primary.btn-small.login-button.btn-icon-text', {
                  href:'https://' + baseURL + '/?discourse_sso=1&redirect_to=https://' + baseURL + '/forum-is-logged-in'
              }, [
                    helper.h('i.tiaa-user-icon.fa.fa-user.d-icon-user'),
                helper.h('span.tiaa-login-text.d-button-label',  'Log In')
              ])
          ]);
      });
    };
</script>
